{
  "hash": "bf0d61a2b1099f335bc2980669c2952d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Hello Quarto: Porting my Website from Hugo Ap√©ro'\nauthor: Silvia Canel√≥n\ndate: '2023-09-29'\ndate-modified: '2023-10-12'\nimage: featured.jpg\ncategories:\n  - R\n  - quarto\n  - website\nsubtitle: >\n  Notes from porting my personal Blogdown website to Quarto\ndescription: ''\nlinks:\n- icon: journal-text\n  name: Quarto Docs\n  url: https://quarto.org/docs/websites/\nfilters:\n   - include-code-files\ncode-annotations: below\ndf-print: paged\nformat:\n  pdf:\n    toc: true\n    number-sections: true\n    colorlinks: true\n---\n\n\n\n\n\n\n## Goodbye, Hugo Ap√©ro\n\nIn 2019 I created my first website using blogdown and the [Hugo Academic theme](https://hugo-academic--silvia.netlify.app/), and in 2021 I migrated that site to the [Hugo Ap√©ro theme](https://hugo-apero--silvia.netlify.app/) created by Alison Hill. I even [documented that trek in great detail üòÖ](../2021-06-01-hello-hugo-apero/) to provide something resembling a paved path for others to use on their journey adopting this beautiful and functional theme. Over the past two years, my Ap√©ro site became a wonderful place to cultivate a [digital garden](https://youtu.be/E5ERSfydB30?feature=shared&t=694)^[See also [Digital gardens let you cultivate your own little bit of the internet | MIT Technology Review](https://www.technologyreview.com/2020/09/03/1007716/digital-gardens-let-you-cultivate-your-own-little-bit-of-the-internet/)]. Now the time has come to say thank you, say goodbye, and travel down a new path. Enter Quarto.\n\n## Why port to Quarto?\n\n[Quarto](https://quarto.org) is a new and powerful technical publishing system in active development, natively friendly to a variety of programming languages and IDEs. There are countless features available in Quarto that I was interested in having access to in my website, so I'll list just my top five:\n\n1. **Flexibility in design.** Quarto offers options for website navigation (top navigation vs. side navigation), \"about\" pages like the [postcard landing pages](https://github.com/seankross/postcards#the-templates) that a lot of folks use in their distill sites, listing pages that are generated from a list of documents, among others. These components would act like modules that I could combine to design a site that truly fit my needs.\n\n1. **Flexibility in content layout.** With Quarto I would gain the ability to organize content in ways I hadn't even dreamt of. Tables and figures could be laid out across multiple columns and rows as sub-tables and sub-figures of a panel. How much of the page the content took up would be up to me. Content could even go in the margin! ü§© [I mean, it's pretty cool that content can go in the margin, right?? <br><br> It could even be a picture: <br><br> ![](featured.jpg){fig-alt=\"There is a book open in the green grass with some yellow leaves around it\"}<br>The book page reads _verdere expedities_ which is Dutch for \"further expeditions\"]{.aside}\n\n1. **Freezing computations.** Quarto would give me the option to [freeze posts](https://quarto.org/docs/websites/website-blog.html#freezing-posts) containing executable code. This was huge for me, because updating my blogdown site always produced a little bit of anxiety. I used to worry that blogdown might try to re-render old R Markdown blog posts and break things! üò±\n\n1. **Site search.** With content spread out over blog posts, talks, publications, and projects, I wanted site visitors (including myself!) to be able to keyword search for something in particular. Tags and categories in blogdown would get me part of the way there, but Quarto offers built-in search capability.\n\n1. **Embedding computations.** Ok this is a feature that I learned about a week ago at posit::conf(2023) from Mine √áetinkaya-Rundel's talk \"Reproducible Manuscripts with Quarto.\" Mine demo'd pulling a table from a `.qmd` file and a figure from an `.ipynb` file into the same manuscript `.qmd` file, _without having to execute the source code again_! üëÄ This is a game changer for anyone compiling results from computations performed in different files, and in my personal site I could see it coming in handy if I have a series of blog posts with outputs that I want to cross-reference. Currently we can only embed computations from Jupyter notebook files, but hopefully we'll be able to embed `.qmd` computations in Quarto v1.4! ü§ûüèΩ\n\n## The cost of porting\n\nGaining the aforementioned Quarto functionality did not come without a cost. To me, the biggest cost was the aesthetics -- the Hugo Ap√©ro theme is quite lovely! -- but I customized my Quarto site enough to reflect the design aspects I loved the most. [More on styling later](#styling-my-site). Some other costs included:\n\n- **Loss of the sidebar layout.** The Ap√©ro theme has options for adding a nicely styled sidebar that I had been using for my blog. It included a featured image and details about the individual post like tags, categories, length, etc. All of this information is available in Quarto posts, it's just organized a little differently.\n\n  <details><summary>Example of the sidebar</summary>\n  ![](img/blog-sidebar-2.png){fig-alt=\"Post title, author, date, and some content on the left hand side, and a sidebar with metadata on the right hand side. The image featured in the sidebar is a cactus plant in a terracota planter, sitting on top of a pile of books\"}\n  </details>\n\n- **Loss of Utterances comments.** Any interactions with folks through Utteranc.es comments did not transfer over, and I'll miss them. The few comments on my site have been very kind (see example below) and I've really enjoy reading them!\n\n  <details><summary>Example of Utterances comments</summary>\n  ![](img/utterances.png){fig-alt=\"User @capolimia says 'Thank you so much!!!!!! This project last year helped me have a great summer, I appreciate your work!!!' and I respond 'Hi @capolimia, thank you for this comment! I don't how how I missed it. I'm happy to hear that the 2022 post was helpful to you! üöÄ'\"}\n  </details>\n\n  ::: {.callout-note appearance=\"simple\" collapse=\"false\"}\n  ## Update: Oct. 12, 2023 \n  Thanks to Emily Riederer, I'm happy to report this is a non-issue! See her tips in the comments at the end of the post, or [on GitHub](https://github.com/spcanelon/silvia/issues/100#issuecomment-1753438790).    \n  :::\n\n- **Hugo Ap√©ro collections.** The Ap√©ro theme had a way of bundling together posts that were related into a collection of posts. Garrick and I used this feature for our [user!2021 xaringan workshop](../../talk/2021-07-07-presentable-user2021/) and it worked well to organize learning materials for different sections of our workshop. If I wanted something like this in the future, I would probably use Quarto's sidebar navigation feature like Andrew Bray did in his [Rmd to Quarto workshop](https://rstudio-conf-2022.github.io/rmd-to-quarto/materials/) for rstudio::conf(2022).\n\n- **Name pronunciation on the About page.** Ap√©ro had a built-in option for adding an audio clip under your name that you could use to help people learn how your name is pronounced. I never used this feature myself, but if I wanted to, I could look to [Emil Hvitfeldt's site](https://github.com/EmilHvitfeldt/emilhvitfeldt.com/blob/main/about.qmd#L20-L24) as an example.\n\n- **Redirects.** The Ap√©ro theme gave me the option to define the combination of date information and URL slugs for each of my posts, and I had them set up as **year-slug** (e.g., blog/2023-hello-quarto). Quarto does not offer that functionality and strictly creates URLs for posts based on the filepath (e.g., blog/2023-09-29-hello-quarto). In order to continue using my **year-month-day-slug** naming convention for my post folders, I had to set up redirects from the old URLs to the new ones so that there wouldn't be broken links sprinkled throughout the internet. [More on redirects later](#setting-up-redirects).\n\n\n## Designing the site\n\nAp√©ro had posts in the `content` folder but with Quarto I could pull blog, talk, publication, and project subfolders into the root folder.\n\n### Structure\n\n::: {.panel-tabset}\n\n### Quarto\n\n```bash\n.\n‚îú‚îÄ‚îÄ _quarto.yml\n‚îú‚îÄ‚îÄ about\n‚îú‚îÄ‚îÄ blog\n‚îú‚îÄ‚îÄ talk\n‚îú‚îÄ‚îÄ publication\n‚îú‚îÄ‚îÄ project\n‚îú‚îÄ‚îÄ index.qmd\n‚îî‚îÄ‚îÄ silvia.Rproj\n```\n\n### Hugo Ap√©ro\n\n```bash\n.\n‚îú‚îÄ‚îÄ content\n‚îÇ   ‚îú‚îÄ‚îÄ _index.md\n‚îÇ   ‚îú‚îÄ‚îÄ about    \n‚îÇ   ‚îú‚îÄ‚îÄ blog      \n‚îÇ   ‚îú‚îÄ‚îÄ project\n‚îÇ   ‚îú‚îÄ‚îÄ publication\n‚îÇ   ‚îî‚îÄ‚îÄ talk\n‚îú‚îÄ‚îÄ config.toml\n‚îú‚îÄ‚îÄ netlify.toml\n‚îú‚îÄ‚îÄ index.Rmd\n‚îî‚îÄ‚îÄ silvia.Rproj\n```\n\n:::\n\n### About & listing pages\n\nI decided to use a combination of [about pages](https://quarto.org/docs/websites/website-about.html) and [listing pages](https://quarto.org/docs/websites/website-listings.html) to replicate the site structure I enjoyed in my Ap√©ro site. I used an about page layout for both my home and about pages, and listing pages to generate a list of blog posts, talks, publications, and projects. There was also some custom CSS involved, but we haven't gotten to that part of the blog post yet wink üòâ [Dear reader, it's at this point in my blog post drafting that I start realizing that what was meant to be a brief post is turning into a novel (*sigh*)]{.aside}\n\nOne of the aspects I liked about my Ap√©ro site was that the About page highlighted the most recent posts from the blog, talk, publication, and project groups. In my Quarto site, I achieved this by including a one-entry listing grid for each group on my [About page](/about/index.qmd).\n\n::: {.callout-caution appearance=\"simple\" collapse=\"true\"}\n## CSS tip\nThese listing cards looked great on a wide screen but as the screen got narrower (think mobile device) the listing cards just became narrower and narrower üòÇ. I took care of this by tweaking the CSS so that the cards would wrap.\n\n```{.css include=\"../../assets/about.css\" start-line=63 end-line=72 filename=\"assets/about.css\"}\n```\n\n[{{< fa code-branch title=\"Git\" >}} source code](https://github.com/spcanelon/silvia/blob/32853dd0e70a71514b0922ee306f80ed5897f776/assets/about.css#L63-L72)\n\n:::\n\n### Contact form\n\nThe last structural piece I wanted to recreate from Ap√©ro was a [contact form](../../contact.qmd). I saw a great example on Michael McCarthy's [Tidy Tales blog](https://tidytales.ca/about/), site and did a little [repo-diving](https://github.com/mccarthy-m-g/tidytales/blob/main/about/index.qmd#L24-L46) to get ideas on how to organize the content. I ended up using the [Bootstrap CSS Grid](https://quarto.org/docs/output-formats/page-layout.html#css-grid) to layout the content exactly how I wanted to. See what I mean about Quarto offering a lot of flexibility in content layout?\n\n::: {.callout-tip appearance=\"simple\" collapse=\"true\"}\n\n## Bones of the contact page\n\n```{.html filename=\"contact.qmd\"}\n\n<!-- start grid -->\n::: {.grid} \n\n<!-- column for the body text -->\n::: {.g-col-5}\n\n# Send me a note\n\n< Body text>\n\n< HTML code for social media icons >\n\n:::\n\n<!-- column for spacing -->\n::: {.g-col-1}\n:::\n\n<!-- column for the form -->\n::: {.g-col-6}\n\n< HTML embed code provided by Formspree >\n\n:::\n\n:::\n<!-- end grid -->\n\n```\n\n[{{< fa code-branch title=\"Git\" >}} source code](https://github.com/spcanelon/silvia/blob/32853dd0e70a71514b0922ee306f80ed5897f776/contact.qmd#L18-L60)\n\n:::\n\n## Adapting old posts\n\n### YAML fields\n\nOk so once I figured out how to incorporate all of the structural elements I wanted, I had to deal with the (relatively small) challenge of porting my old posts to Quarto. Quarto was designed to be compatible with existing R Markdown documents, but I didn't actually want it trying to re-render old R Markdown files so I had Quarto ignore those completely^[By adding an underscore prefix (e.g., _index.Rmarkdown)] and render the Markdown version of each post instead^[I.e., index.markdown]. There were also a handful of YAML fields that I had to remove or modify to play nicely with Quarto:\n\n- Remove `layout:` (e.g., `layout: single-sidebar`)\n- Remove `publishDate`\n- Remove `lastUpdated`\n- Remove `featured` (e.g., `featured: yes`)\n- Merge `categories` with `tags` and keep `tags`\n- Add `image` (e.g. `image: featured.png`)\n\n### Partials\n\nIf you've used Ap√©ro you might have come to love the cute button links created from the `links` field in the YAML, like the one at the top of this post, pointing to the Quarto docs.\n\n```yaml\nlinks:\n- icon: journal-text\n  name: Quarto Docs\n  url: https://quarto.org/docs/websites/\n```\n\nWell, these button links are not ready-made by Quarto, but lucky for me (us!), Garrick figured out a way to bring them in right where we I need them. I repo-dived and found that he modified an [HTML partial for title blocks](https://quarto.org/docs/journals/templates.html#html-partials), which controls the layout and styling of the post title, description, and tags, shown at the top of the page.\n\nThe original title block partial has sections controlling the placement and styling of text provided in the title, subtitle, authors, date, and abstract fields of the document YAML.\n\n[As an example, line 2 might read:<br>If there's something in the **title** field of the YAML, give it a level 1 heading and style it with CSS class `.title`]{.aside}\n\n```{.html code-line-numbers=\"true\" filename=\"github.com/quarto-dev/quarto-cli/src/resources/formats/html/pandoc/title-block.html\"}\n<header id=\"title-block-header\">\n$if(title)$<h1 class=\"title\">$title$</h1>$endif$\n$if(subtitle)$\n<p class=\"subtitle\">$subtitle$</p>\n$endif$\n$for(author)$\n<p class=\"author\">$author$</p>\n$endfor$\n\n$if(date)$\n<p class=\"date\">$date$</p>\n$endif$\n$if(abstract)$\n<div class=\"abstract\">\n<div class=\"abstract-title\">$abstract-title$</div>\n$abstract$\n</div>\n$endif$\n</header>\n```\n\nThe [modified partial {{< fa code-branch title=\"Git\" >}}](https://github.com/spcanelon/silvia/blob/32853dd0e70a71514b0922ee306f80ed5897f776/_partials/title-block-link-buttons/title-block.html) includes some additional sections but I'll break down the one for links.\n\n[There's more styling going on in the modified partial, but starting on line 6, the structure for the link buttons is effectively:<br><br>If the **links** field is populated in the YAML, create an HTML container styled by some CSS, and give it some specific HTML properies.<br><br>Then, for each sub-item of the **links** field: create a hyperlink from the **url** sub-item, apply some CSS classes to create the button, add a Bootstrap icon defined by the **icon** sub-item, and finally add hyperlink text defined by the **name** sub-item.]{.aside}\n\n```{.html code-line-numbers=\"true\" filename=\"_partials/title-block-link-buttons/title-block.html\"}\n<header id=\"title-block-header\" class=\"quarto-title-block default page-columns\">\n...\n$if(links)$\n<div class=\"mt-4 d-flex flex-row flex-wrap gap-1 justify-content-left justify-content-sm-start\" role=\"group\" aria-label=\"Links\">\n$for(links)$\n<a href=\"$links.url$\" class=\"btn btn-secondary text-capitalize\"><i class=\"bi bi-$links.icon$ me-1\"></i>$links.name$</a>\n$endfor$\n</div>\n$endif$\n...\n</header>\n```\n\n## Styling the site\n\n### SCSS variables\n\nI may have published my brand new Quarto site in the fall of 2023, but I had actually taken my first go at porting it from Ap√©ro in the fall of 2022. In an attempt to replicate the styling of my old site I tried to strong-arm my Quarto site into using tachyons^[A CSS design system used in the Hugo Ap√©ro theme: <https://tachyons.io>], and I wrote **way too much** custom CSS in the process üò©.\n\nSomething didn't feel right about it, so I took a break and came back to my in-progress Quarto site several months later -- outside of the Quarto release craze, and with the perspective that I wanted to work _with_ the built-in theming capabilities, rather than against them üòå. This time around I leaned into the Bootstrap SCSS variables, and added custom styling as needed.\n\nTo be more specific, I created a [custom theme {{< fa code-branch title=\"Git\" >}}](https://github.com/spcanelon/silvia/blob/32853dd0e70a71514b0922ee306f80ed5897f776/assets/silvia-theme.scss)^[For more on custom theming, see [Quarto - HTML Theming](https://quarto.org/docs/output-formats/html-themes.html#custom-themes) and [Quarto - More About Quarto Themes](https://quarto.org/docs/output-formats/html-themes-more.html)], and populated it with definitions for some of the [built-in Bootstrap Sass variables](https://quarto.org/docs/output-formats/html-themes.html#sass-variables). If you poke around my custom theme, you will notice that some colors are defined by color variables that start with `$spc-`. These are variables pointing to colors that I've defined elsewhere, and they can be replaced with a hex code of your choosing! üé®\n\n```{.scss filename=\"assets/silvia-theme.scss\"}\n/*-- scss:defaults --*/\n\n// Colors\n$primary:                    $spc-primary-light;\n$secondary:                  $spc-secondary;\n```\n\nThe Sass variables listed in the documentation got me pretty far, but there were still elements of my site using default colors and styling that I wanted to change. So I repo-dived to learn about additional Quarto Bootstrap variables and rules:\n\n- Bootstrap variables: <https://github.com/quarto-dev/quarto-cli/blob/main/src/resources/formats/html/bootstrap/_bootstrap-variables.scss>\n- Bootstrap rules: <https://github.com/quarto-dev/quarto-cli/blob/main/src/resources/formats/html/bootstrap/_bootstrap-rules.scss>\n\nTo give you an example, someone in the Quarto Discussions forum asked [how to set the color of block quotes, figure captions, and outlines](https://github.com/quarto-dev/quarto-cli/discussions/2490), something not defined in the documentation. One of the replies suggested using the browser's inspector to find the CSS rule applied to the element in question, we'll say the figure caption, and then looking at how Quarto implemented that rule. I'll make that process a little more explicit here and use the figure caption as an example:\n\n1. Use the browser inspector to highlight a figure caption\n1. The inspector will reveal that the element is styled by CSS class `.figure-caption`\n1. Run a keyword search for \"figure-caption\" in the [Bootstrap variables file](https://github.com/quarto-dev/quarto-cli/blob/main/src/resources/formats/html/bootstrap/_bootstrap-variables.scss). This will yield no results ü§î\n1. Run the same keyword search in the [Bootstrap rules file](https://github.com/quarto-dev/quarto-cli/blob/main/src/resources/formats/html/bootstrap/_bootstrap-rules.scss) -- success! We have a clue, which is that `.figure-caption` is styled by a variable named `body-secondary` üîç\n\n    ```{.scss}\n    .panel-caption,\n    .figure-caption,\n    .subfigure-caption,\n    .table-caption,\n    figcaption.quarto-float-caption,\n    caption {\n      font-size: 0.9rem;\n      @include body-secondary;\n    }\n    ```\n1. Define your own `body-secondary` color variable in your custom theme file\n\n    ```{.scss filename=\"assets/custom-theme.scss\"}\n    /*-- scss:defaults --*/\n\n    $body-secondary: #6C757D;\n    ```\n1. Enjoy the fruits of your labor as a CSS detective üïµüèΩ‚Äç‚ôÄÔ∏è\n\n### Individual page styling\n\nIn some cases, I wanted to style individual pages differently than I was styling my entire site. Poking around Garrick's repo (again!), I learned that you can reference CSS stylesheets in the YAML of any particular document. I used this approach to separately style my Home, About, and listing pages.\n\n```{.yml include=\"../../index.qmd\" start-line=42 end-line=45 filename=\"index.qmd\" code-line-numbers=\"true\"}\n```\n\n- `index.qmd` [{{< fa code-branch title=\"Git\" >}} source code](https://github.com/spcanelon/silvia/blob/32853dd0e70a71514b0922ee306f80ed5897f776/index.qmd#L42-L45)\n- `assets/index.css` [{{< fa code-branch title=\"Git\" >}} source code](https://github.com/spcanelon/silvia/blob/32853dd0e70a71514b0922ee306f80ed5897f776/assets/index.css)\n\n### Background image for title blocks\n\nOk one of the aesthetic pieces I was excited to add to my Quarto site that I _didn't_ have in my old site is a featured image at the top of each post. I was inspired by Matt Worthington's site while I was reading one of his excellent blog posts on [a workflow for interactive maps in R](https://www.mrworthington.com/articles/rstats/mapping-in-r/) -- I loved that the title block included an image in the background! ü§©\n\nAfter some web inspecting and [repo-diving in Matt's website repo](https://github.com/mrworthington/mrworthington.github.io/blob/master/articles/rstats/mapping-in-r/page_header.css) I came up with some styling that I could apply to the title block of each post. It took modifying the [title block partial](#partials) described earlier, and adding some CSS to my custom theme.\n\nFor styling that I wanted to apply uniformly to all post title blocks, I created a `.featured-image` CSS class in my custom theme:\n\n[Don't miss the [code annotations](https://quarto.org/docs/authoring/code-annotation.html) for this code chunk! üëÄ <br>Such a cool feature!]{.aside}\n\n```{.scss filename=\"assets/custom-theme.scss\"}\n  // style background image on posts\n  .featured-image {\n    background-size: cover;       // <1>\n    background-position: center;  // <2>\n    color: white;                 // <3>\n    box-shadow: inset 0 0 0 1000px rgba(0,38,66,0.75); // <4>\n  }\n```\n\n1. Have the image cover the background\n2. Center the image\n3. Make the overlaying text color white\n4. Add shadowing that gives the appearance of a dark overlay\n\nAlright, but why didn't I use a `background-image` property to define the image? If I define the background image in my `.featured-image` class then that is the image that's going to show up in all of the posts across my site. I want the title block of each post to display the featured image belonging to each individual post. That's where the partial comes back in.\n\n```{.html filename=\"_partials/title-block-link-buttons/title-block.html\"}\n<div \nid=\"title-block-header-title\" \nclass=\"quarto-title page-columns page-full page-layout-full featured-image p-4\" \nstyle=\"background-image: url(featured.png), url(featured.jpg), url(../featured.jpg);\">\n...\n</div>\n```\n  \nAlong with some other CSS classes, the div container for the title block is styled with the `featured-image` class defined earlier, using the `class=` property. In addition, the div itself is styled using the `style=` property, and that's where I defined the background image. The partial will look for a featured image of some kind either in the same folder as the post, or in the parent folder, and display it in the background of the title block. \n\nThis is a hacky way of getting what I really want which is for the partial to check for a featured image in the order I specify and then just stop once it finds one. As it stands right now, the styling attempts to layer on all three images, with the first image on the top and the last image on the bottom. This means that I get a warning every time I preview or render my site because the partial can't find one or two of the other urls, but I'm ok with that!\n\n::: {.callout-caution appearance=\"simple\"}\n## Example warning\n\n```md\n/blog/2023-09-29-hello-quarto/featured.png (404: Not Found)\n```\n:::\n\n## Setting up redirects\n\n### Resources\n\nLast but not least, I can't finish this blog post without talking about the necessary task of redirecting old Ap√©ro URLs to new Quarto ones ^[Don't skip this step! People will almost certainly have shared one or more of your posts somewhere on the internet, and it helps everyone if you can point them to the right spot]. Many thanks to Danielle Navarro and Tom Mock for documenting their solutions for automatically generating a `_redirects` file with each render of the site.\n\n- Danielle's blog post: [Notes from a data witch - Porting a distill blog to quarto](https://blog.djnavarro.net/posts/2022-04-20_porting-to-quarto/#netlify-redirects)\n- Tom's source code: [index.qmd - The MockUp](https://github.com/jthomasmock/themockup-blog/blob/bb069ef7315ad47d877f27c5052cc886ad80818e/index.qmd#L27C1-L48C4)\n\nI adapted their code to (1) fit my site, which has multiple folders of posts that all need redirects, and (2) combine these automatically generated redirects with ones I had already defined manually. I placed this code within my [home page index.qmd file {{< fa code-branch title=\"Git\" >}} ](https://github.com/spcanelon/silvia/blob/main/index.qmd#L61-L114) and I specified `freeze: false` in the YAML so that the code would run each time I rendered the site. The following sections will take a look at the code piece by piece.\n\n### Importing manual redirects\n\nThe first step imports the manually-defined redirects that I had already been using in my old site. These redirects primarily have the task of redirecting my `rbind.io` domain to my custom domain `silviacanelon.com`.\n\n\n\n\n::: {.cell filename='index.qmd'}\n\n```{.r .cell-code}\nmanual_redirects <-\n  readr::read_table(here::here(\"static\", \"_manualredirects.txt\"),\n                    col_names = FALSE) |> \n  dplyr::mutate(redirect = paste0(X1, \" \", X2, \" \", X3))\n\nmanual_redirects <- manual_redirects$redirect\n\nhead(manual_redirects)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"https://silvia.rbind.io/authors/silvia/avatar.png https://silviacanelon.com/about/sidebar/avatar.png 301!\"\n[2] \"https://silvia.rbind.io/post/* https://silviacanelon.com/blog/:splat 301!\"                                \n[3] \"https://silvia.rbind.io/blog/* https://silviacanelon.com/blog/:splat 301!\"                                \n[4] \"https://silvia.rbind.io/talk/* https://silviacanelon.com/talk/:splat 301!\"                                \n[5] \"https://silvia.rbind.io/project/* https://silviacanelon.com/project/:splat 301!\"                          \n[6] \"http://silvia.rbind.io/* https://silviacanelon.com/:splat 301!\"                                           \n```\n\n\n:::\n:::\n\n\n\n\n### Listing subdirectories\n\nThe next step defines a function that obtains a list of subdirectories, iterates it over the four groups of posts in my site (blog posts, talks, publications, and projects), and compiles the files into a data frame.\n\n\n\n\n::: {.cell filename='index.qmd'}\n\n```{.r .cell-code}\n# function: obtain list of post paths\nlist_paths <- function(folder) {\n  posts <-\n    list.dirs(\n    path = c(here::here(folder)),\n    full.names = FALSE,\n    recursive = FALSE\n    ) |> \n    tibble::as_tibble_col(column_name = \"path\")  |>\n    dplyr::mutate(folder = folder)\n}\n\n# define post folders\nfolders <- c(\"blog\", \"project\", \"publication\", \"talk\")\n\n# list post paths by folder\nposts <- purrr::map(folders, list_paths) |> purrr::list_rbind()\n\nhead(posts)\n```\n\n::: {.cell-output-display}\n\n|path                                                  |folder |\n|:-----------------------------------------------------|:------|\n|2020-05-12-trello-to-airtable                         |blog   |\n|2020-05-26-dark-mode-custom-with-atom                 |blog   |\n|2020-10-07-rstudio-instructor-certification-tidyverse |blog   |\n|2021-03-16-deploying-xaringan-slides                  |blog   |\n|2021-06-01-hello-hugo-apero                           |blog   |\n|2021-06-02-wave-audit-1                               |blog   |\n\n:::\n:::\n\n\n\n\n### Defining redirects\n\nThis next chunk removes the month and day from **year-month-day-slug** so that I'm left with shorter paths with the format **year-slug**, and uses these paths and the folders they are housed in to create redirects.\n\nThe resulting redirects will point the short **year-slug** link to this blog post:\n\n<https://silviacanelon.com/blog/2023-hello-quarto>\n\nTo the longer **year-month-day-slug** Quarto link to this post:\n\n<https://silviacanelon.com/blog/2023-09-29-hello-quarto>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# extract short paths and create redirects\nposts <- \n  posts |> \n  dplyr::mutate(\n    # extract the year-slugs\n    short_path = stringr::str_remove(path, \"(?!\\\\d{4}-)\\\\d{2}-\\\\d{2}-(?!\\\\d)\"),\n    # create short paths\n    short_path = paste0(folder, \"/\", short_path),\n    # create lines to insert to a netlify _redirect file\n    redirects = paste0(\"/\", short_path, \" \", \"/\", folder, \"/\", path)\n    )\n\nhead(posts)\n```\n\n::: {.cell-output-display}\n\n|path                                                  |folder |short_path                                           |redirects                                                                                                         |\n|:-----------------------------------------------------|:------|:----------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------|\n|2020-05-12-trello-to-airtable                         |blog   |blog/2020-trello-to-airtable                         |/blog/2020-trello-to-airtable /blog/2020-05-12-trello-to-airtable                                                 |\n|2020-05-26-dark-mode-custom-with-atom                 |blog   |blog/2020-dark-mode-custom-with-atom                 |/blog/2020-dark-mode-custom-with-atom /blog/2020-05-26-dark-mode-custom-with-atom                                 |\n|2020-10-07-rstudio-instructor-certification-tidyverse |blog   |blog/2020-rstudio-instructor-certification-tidyverse |/blog/2020-rstudio-instructor-certification-tidyverse /blog/2020-10-07-rstudio-instructor-certification-tidyverse |\n|2021-03-16-deploying-xaringan-slides                  |blog   |blog/2021-deploying-xaringan-slides                  |/blog/2021-deploying-xaringan-slides /blog/2021-03-16-deploying-xaringan-slides                                   |\n|2021-06-01-hello-hugo-apero                           |blog   |blog/2021-hello-hugo-apero                           |/blog/2021-hello-hugo-apero /blog/2021-06-01-hello-hugo-apero                                                     |\n|2021-06-02-wave-audit-1                               |blog   |blog/2021-wave-audit-1                               |/blog/2021-wave-audit-1 /blog/2021-06-02-wave-audit-1                                                             |\n\n:::\n:::\n\n\n\n\n### Writing redirects file\n\nThe last step takes the **redirects** from the data frame produced in the previous step, combines them with the manual redirects, and writes them to a new text file `_redirects`. This file is written into the `_site` folder where my Quarto site is rendered, and where Netlify will know to find it.\n\n\n\n\n::: {.cell filename='index.qmd'}\n\n```{.r .cell-code}\n# extract redirects\nredirects <- posts$redirects\n\n# combine with manual redirects\nredirects_combined <- c(manual_redirects, redirects)\n\n# write the _redirect file\nwriteLines(redirects_combined, here::here(\"_site\", \"_redirects\"))\n```\n:::\n\n\n\n\n## Fin\n\nNow that it's been over a year since Quarto made its debut, there are so many wonderful blog posts walking folks through how to create a Quarto site. My hope is that the notes I took in this blog post help provide some stepping stones for folks making the transition from blogdown sites, and offer some ideas for what is possible with the flexibility of this new publishing framework. I, for one, am looking forward to growing my digital garden with Quarto tools üå±.\n\n## Acknowledgments {.appendix}\n\nFeatured photo by <a href=\"https://unsplash.com/@anneliesgeneyn?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Annelies Geneyn</a> on <a href=\"https://unsplash.com/photos/bhBONc07WsI?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Unsplash</a>.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}